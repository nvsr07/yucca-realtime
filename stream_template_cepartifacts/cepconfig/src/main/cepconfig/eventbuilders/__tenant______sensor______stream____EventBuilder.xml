<@pp.dropOutputFile />
<#if source.type!="Internal">
<#list mbs as mb>
<@pp.changeOutputFile
name=mb.num+"__"+tenant.code+"__"+source.code_+"_"+stream.code+"__EventBuilder.xml"
/>
<?xml version="1.0" encoding="UTF-8"?>
<eventBuilder
	name="${tenant.code}__${source.code_}__${stream.code}__EventBuilder"
	statistics="disable" trace="disable" xmlns="http://wso2.org/carbon/eventbuilder">
	<from eventAdaptorName="JMSMBInternalInputEventAdaptor"
		eventAdaptorType="jms">
		<property name="transport.jms.Destination">VirtualQueueConsumer.${mb.num}.input.${tenant.code}.${source.code}_${stream.code}
		</property>
	</from>
	<mapping customMapping="enable" type="json">
		<#if source.type = "Application">
		<property>
			<from jsonPath="application" />
			<to name="meta_source" type="string" />
		</property>
		<#elseif source.type = "Device">
		<property>
			<from jsonPath="sensor" />
			<to name="meta_source" type="string" />
		</property>
		</#if>
		<property>
			<from jsonPath="values.time" />
			<to name="time" type="string" />
		</property>
		<#list components as component>
		<property>
			<from jsonPath="values.components.${component.code}" />
<#if component.type = "dateTime">			
			<to name="${component.code}" type="string" />
<#else/>
			<to name="${component.code}" type="${component.type}" />
</#if>			
		</property>
		</#list>
	</mapping>
	<to streamName="input__${tenant.code}__${source.code_}__${stream.code}"
		version="1.0.0" />
</eventBuilder>
</#list>
</#if>  