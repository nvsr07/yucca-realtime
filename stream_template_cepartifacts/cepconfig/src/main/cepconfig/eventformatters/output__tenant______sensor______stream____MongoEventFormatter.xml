<@pp.dropOutputFile />
<#if stream.persisted?? && stream.persisted = "true">
<@pp.changeOutputFile name="output__"+tenant.code+"__"+source.code_+"_"+stream.code+"__MongoEventFormatter.xml" />
<?xml version="1.0" encoding="UTF-8"?>
<eventFormatter name="output__${tenant.code}__${source.code_}__${stream.code}__MongoEventFormatter"
  statistics="disable" trace="disable" xmlns="http://wso2.org/carbon/eventformatter">
  <from streamName="output__${tenant.code}__${source.code_}__${stream.code}" version="1.0.0"/>
<mapping customMapping="enable" type="json">
    <inline>
{
 "id_sensore": "{{meta_source}}",
 "id_flusso": "${stream.code}",
  "domain": "temperatura",
"Values": [
  {
   "time": "{{time}}",
   "components": [<#list components as component>
	{
		 "id": "c0",
		 "unit": "gradi centigradi",
		 "event":"temperatura",
		 "type": "numero",
		 "valore": "{{c0}}"
	} <#if component_has_next>,</#if>
</#list> 
    ]
   }
  ]
}    
  </inline>
  </mapping>
	<to eventAdaptorName="MongoDB" eventAdaptorType="mongoDB">
    <property name="username">a</property>
    <property name="collection">${stream.code}Collection</property>
    <property name="password">a</property>
    <property name="database">${tenant.code}</property>
  </to>
  </eventFormatter>
</#if>
